<h1>Productos</h1>

<form method="GET" action="/products" style="margin-bottom:16px;">
    <input name="query" placeholder="categoria o available/unavailable" value="{{query}}" />
    <select name="sort">
        <option value="" {{#unless sort}}selected{{/unless}}>sin orden</option>
        <option value="asc" {{#if (eq sort "asc")}}selected{{/if}}>precio asc</option>
        <option value="desc" {{#if (eq sort "desc")}}selected{{/if}}>precio desc</option>
    </select>
    <input name="limit" type="number" min="1" value="{{limit}}" style="width:90px;" />
    <button type="submit">Aplicar</button>
</form>

{{#if products.length}}
    {{#each products}}
        <div class="card">
        <strong>{{title}}</strong> — ${{price}} — stock: {{stock}} — cat: {{category}}
        <div class="muted">{{description}}</div>

        <div style="margin-top:8px;">
            <a href="/products/{{_id}}">Ver detalle</a>
        </div>
        </div>
    {{/each}}
    {{else}}
    <p>No hay productos.</p>
{{/if}}

<div style="display:flex; gap:12px; margin-top:16px; align-items:center;">
    {{#if hasPrevPage}}
        <a href="/products?page={{prevPage}}&limit={{limit}}&sort={{sort}}&query={{query}}">⬅ Prev</a>
    {{/if}}

    <span>Página {{page}} / {{totalPages}}</span>

    {{#if hasNextPage}}
        <a href="/products?page={{nextPage}}&limit={{limit}}&sort={{sort}}&query={{query}}">Next ➡</a>
    {{/if}}
</div>
